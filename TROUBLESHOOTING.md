# Устранение неполадок в BA Assist

## Общие инструкции по запуску

Для полноценной работы приложения BA Assist требуется запустить два компонента:

1. **Основное приложение** (Next.js):
   ```bash
   cd C:\baas\baassist
   npm install
   npm run dev
   ```

2. **Сервис парсера** (Express.js):
   ```bash
   cd C:\baas\baassist\parser
   npm install
   npm start
   ```

Эти два сервиса должны работать одновременно, чтобы обеспечить все функции приложения.

## Проблемы с обработкой файлов

Если при нажатии кнопки "Обработать" появляется ошибка "Не удалось обработать файл", выполните следующие шаги:

### 1. Проверьте запущен ли парсер-сервис

Откройте новый терминал и запустите parser-сервис:

```bash
cd C:\baas\baassist\parser
npm start
```

Вы должны увидеть сообщение:
```
Сервис обработки файлов запущен на порту 4000
```

### 2. Проверьте доступность парсера

Откройте браузер и перейдите по адресу:
```
http://localhost:4000/health
```

Вы должны увидеть ответ: `{"status":"ok"}`

### 3. Проверьте настройки в .env файле

Убедитесь, что в файле `.env` корректно указан URL парсера:

```
PARSER_URL="http://localhost:4000/extract-text"
```

### 4. Проверьте формат файла

Сервис парсера поддерживает следующие форматы:
- Microsoft Word (.doc, .docx)
- Текстовые файлы (.txt)
- PDF (.pdf) - *базовая поддержка в MVP-Lite*

### 5. Проверьте логи приложения

При возникновении проблем с обработкой файла проверьте логи в консоли, где запущено основное приложение. Там должны отображаться подробные сообщения о каждом шаге обработки файла.

### 6. Используйте страницу диагностики

В приложении доступна страница диагностики, которая показывает статус всех компонентов и предлагает решения возникающих проблем:

```
http://localhost:3000/dashboard/troubleshoot
```

## Проблемы с загрузкой файлов

Если возникают проблемы при загрузке файлов:

### 1. Проверьте настройки Google Cloud Storage

Убедитесь, что в файле `.env` корректно указаны настройки GCS:

```
GCS_PROJECT_ID="ba-assistant-project"
GCS_BUCKET="baassist-files"
GCS_KEY_FILE="./keys/ba-assistant-project-f67510680f7a.json"
USE_REAL_GCS="true"
```

### 2. Проверьте ключ сервисного аккаунта

Убедитесь, что файл ключа сервисного аккаунта существует и имеет корректный формат. Если возникают проблемы, создайте новый ключ в Google Cloud Console.

### 3. Проверьте существование бакета

Убедитесь, что бакет `baassist-files` существует в вашем проекте Google Cloud. Если нет, создайте его:

```bash
gsutil mb gs://baassist-files
```

## Дополнительные ресурсы

- Посетите страницу диагностики в приложении: `/dashboard/troubleshoot`
- Запустите скрипт проверки parser-сервиса: `node scripts/check-parser.js`
- Проверьте README файл parser-сервиса: `parser/README.md`